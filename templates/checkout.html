{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    {% if object.book_available is True %}
    <div class="row">
        <div class="col-lg-5">
            <div class="card shadow-sm">
                <img src="{{ object.image_url }}" class="card-img-top p-2" alt="{{ object.title }}">
            </div>
        </div>

        <div class="col-lg-7">
            <div class="card card-body shadow-sm">
                <h3 class="font-weight-bold">{{ object.title }}</h3>
                <p class="text-muted">–ê–≤—Ç–æ—Ä—É: {{ object.author }}</p>
                <hr>
                <h4 class="text-success">–¢”©–ª”©–Ω“Ø“Ø—á“Ø —Å—É–º–º–∞: {{ object.price|floatformat:2 }} —Å–æ–º</h4>
                <hr>

                <div class="p-3 mb-4" style="background-color: #f8f9fa; border-left: 5px solid #007bff; border-radius: 5px;">
                    <h5 class="text-primary"><strong>–ú–±–∞–Ω–∫ –∞—Ä–∫—ã–ª—É—É —Ç”©–ª”©”©:</strong></h5>
                    <p class="mb-1">–¢”©–ª”©–º–¥“Ø —Ç”©–º”©–Ω–∫“Ø –Ω–æ–º–µ—Ä–≥–µ –∫–æ—Ç–æ—Ä—É“£—É–∑:</p>
                    <h4 class="font-weight-bold">+996 707 20 41 18</h4>
                    <p class="mb-0 text-secondary"><strong>–ê–ª—É—É—á—É:</strong> (–†–∞–π—Ö–∞–Ω –ê)</p>
                </div>

                <div class="mb-4">
                    <h5 class="text-dark font-weight-bold">–ñ–µ—Ç–∫–∏—Ä“Ø“Ø –º–∞–∞–ª—ã–º–∞—Ç—Ç–∞—Ä—ã:</h5>
                    <div class="form-group">
                        <input type="text" id="cust_name" class="form-control mb-2" placeholder="–ê—Ç—ã-–∂”©–Ω“Ø“£“Ø–∑" required>
                        <input type="text" id="cust_phone" class="form-control mb-2" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω –Ω–æ–º–µ—Ä–∏“£–∏–∑" required>
                        <textarea id="cust_address" class="form-control" placeholder="–ñ–µ—Ç–∫–∏—Ä“Ø“Ø –¥–∞—Ä–µ–≥–∏ (–®–∞–∞—Ä, –∫”©—á”©, “Ø–π)" rows="2" required></textarea>
                    </div>
                </div>

                <p class="small text-muted">
                    * –¢”©–ª”©–º–¥“Ø –∞—Ç–∫–∞—Ä—ã–ø, –¥–∞—Ä–µ–≥–∏“£–∏–∑–¥–∏ –∂–∞–∑–≥–∞–Ω–¥–∞–Ω –∫–∏–π–∏–Ω WhatsApp –∞—Ä–∫—ã–ª—É—É —á–µ–∫ –º–µ–Ω–µ–Ω –º–∞–∞–ª—ã–º–∞—Ç—Ç—ã –∂”©–Ω”©—Ç“Ø“£“Ø–∑.
                </p>

                <button onclick="sendWhatsApp()" class="btn btn-success btn-lg btn-block shadow">
                    <i class="fab fa-whatsapp"></i> –¢”©–ª”©–º —á–µ–≥–∏–Ω –∂–∞–Ω–∞ –¥–∞—Ä–µ–∫—Ç–∏ –∂”©–Ω”©—Ç“Ø“Ø
                </button>
            </div>
        </div>
    </div>

    {% else %}
    <div class="text-center mt-5 p-5 bg-white shadow rounded">
        <h4 class="text-danger">–ö–µ—á–∏—Ä–µ—Å–∏–∑, –±—É–ª –∫–∏—Ç–µ–ø –∫–∞–º–ø–∞–¥–∞ –∂–æ–∫!</h4>
        <a href="/" class="btn btn-primary mt-3">–ë–∞—à–∫—ã –±–µ—Ç–∫–µ –∫–∞–π—Ç—É—É</a>
    </div>
    {% endif %}
</div>

<script>
    function sendWhatsApp() {
        // –ú–∞–∞–ª—ã–º–∞—Ç—Ç–∞—Ä–¥—ã –∫–∏—Ä–≥–∏–∑“Ø“Ø —Ç–∞–ª–∞–∞–ª–∞—Ä—ã–Ω–∞–Ω –∞–ª–∞–±—ã–∑
        var name = document.getElementById('cust_name').value;
        var phone = document.getElementById('cust_phone').value;
        var address = document.getElementById('cust_address').value;
        var bookTitle = "{{ object.title }}";

        // –≠–≥–µ—Ä —Ç–∞–ª–∞–∞–ª–∞—Ä –±–æ—à –±–æ–ª—Å–æ —ç—Å–∫–µ—Ä—Ç“Ø“Ø –±–µ—Ä–µ–±–∏–∑
        if (name == "" || phone == "" || address == "") {
            alert("–°—É—Ä–∞–Ω—ã—á, –∂–µ—Ç–∫–∏—Ä“Ø“Ø –º–∞–∞–ª—ã–º–∞—Ç—Ç–∞—Ä—ã–Ω —Ç–æ–ª—É–∫ —Ç–æ–ª—Ç—É—Ä—É“£—É–∑!");
            return;
        }

        // –ë–∏–ª–¥–∏—Ä“Ø“Ø–Ω“Ø–Ω —Ç–µ–∫—Å—Ç–∏–Ω —Ç“Ø–∑”©–±“Ø–∑
        var message = "–°–∞–ª–∞–º–∞—Ç—Å—ã–∑–±—ã! –ú–µ–Ω ¬´" + bookTitle + "¬ª –∫–∏—Ç–µ–±–∏–Ω–µ —Ç”©–ª”©–¥“Ø–º.\n\n" +
                      "üì¶ *–ñ–µ—Ç–∫–∏—Ä“Ø“Ø –º–∞–∞–ª—ã–º–∞—Ç—Ç–∞—Ä—ã:* \n" +
                      "üë§ –ê—Ç—ã: " + name + "\n" +
                      "üìû –¢–µ–ª: " + phone + "\n" +
                      "üìç –î–∞—Ä–µ–∫: " + address + "\n\n" +
                      "–ú—ã–Ω–∞ —Ç”©–ª”©–º —á–µ–≥–∏:";

        // –¢–µ–∫—Å—Ç—Ç–∏ —à–∏–ª—Ç–µ–º–µ–≥–µ –∞–π–ª–∞–Ω—Ç–∞–±—ã–∑
        var encodedMessage = encodeURIComponent(message);
        var whatsappUrl = "https://wa.me/996500005585?text=" + encodedMessage;

        // WhatsApp'–∫–∞ –±–∞–≥—ã—Ç—Ç–∞–π–±—ã–∑
        window.open(whatsappUrl, '_blank');
    }
</script>

<style>
    body {
        background-color: #f4f7f6;
    }
    .card {
        border: none;
        border-radius: 10px;
    }
    .form-control {
        border-radius: 8px;
        border: 1px solid #ced4da;
    }
    .form-control:focus {
        border-color: #007bff;
        box-shadow: 0 0 5px rgba(0,123,255,.25);
    }
</style>
{% endblock content %}